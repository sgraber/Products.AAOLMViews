Based on Scrawl 1.3.x svn/unreleased